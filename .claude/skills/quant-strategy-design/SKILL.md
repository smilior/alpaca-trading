---
name: quant-strategy-design
description: |
  売買シグナルと戦略ロジックを設計するためのクオンツ戦略設計スキル。
  以下のキーワードでトリガーする：「売買シグナル」「テクニカル指標」「エントリー」
  「エグジット」「バックテスト」「戦略設計」「アルゴリズム」「トレーディング戦略」
  「RSI」「MACD」「移動平均」「ボリンジャーバンド」「シグナル」「α（アルファ）」
  「ファクター」「オーバーフィッティング」「ウォークフォワード」「最適化」。
  トレーディング戦略の設計・検証時に必ず使用すること。
---

# クオンツ戦略設計スキル

## このスキルの目的

検証可能で再現性のあるトレーディング戦略を設計せよ。「なんとなく動くもの」ではなく、統計的に根拠のある戦略を目指す。

## なぜ体系的な設計が必要か

- **直感的な戦略は破綻する**: 「RSIが30以下で買えば儲かりそう」→ バックテストすると大抵負ける
- **オーバーフィッティングは最大の敵**: 過去データに合わせすぎた戦略は未来で確実に失敗する
- **再現性がなければ改善できない**: 「なぜ勝ったか」「なぜ負けたか」を説明できなければ改善のしようがない

## 戦略設計の基本フロー

```
1. 仮説の構築
   「なぜこの戦略が利益を生むか」の理論的根拠を明確にする

2. シグナル設計
   エントリー・エグジットの条件を定義する

3. バックテスト
   過去データで戦略を検証する

4. 結果の分析
   統計的に有意かどうかを判断する

5. ウォークフォワード検証
   未知のデータで再検証する

6. ペーパートレーディング
   リアルタイムで検証する
```

**重要: 1→2→3→4→5→6の順序を飛ばしてはならない。特に1（仮説）を飛ばして2（シグナル設計）に進むのは禁止。**

## ステップ1: 仮説の構築

### なぜ仮説が必要か

仮説なしにパラメータを最適化すると、過去のノイズにフィットするだけ。仮説があれば「なぜうまくいくはず」かが説明でき、「なぜうまくいかなかったか」も分析できる。

### 仮説のテンプレート

```
もし[市場の非効率性/パターン]が存在するならば、
[特定の条件]のとき[特定の行動]をとることで、
[期待されるリターン]が得られるはずだ。

なぜなら[理論的根拠]だからだ。
```

### 良い仮説と悪い仮説

```
❌ 悪い仮説:
「AIを使えば株で儲かる」
→ 具体性ゼロ。検証不能。

❌ 悪い仮説:
「RSIが30以下で買えば儲かる」
→ なぜRSI<30が利益を生むかの理論的根拠がない

✅ 良い仮説:
「決算発表後、LLMが"ポジティブ"と判定したにもかかわらず
株価が下落した銘柄は、3日以内にリバウンドする確率が高い。
なぜなら、アルゴリズムトレーダーの初期反応がネガティブな
ヘッドラインに過剰反応し、内容を精査した後に修正されるため」
→ 具体的で、検証可能で、理論的根拠がある
```

## ステップ2: シグナル設計

テクニカル指標の詳細は [references/technical-indicators.md](references/technical-indicators.md) を参照。
シグナル設計パターンは [references/signal-design.md](references/signal-design.md) を参照。

## ステップ3: バックテスト

バックテストの手法と落とし穴は [references/backtesting.md](references/backtesting.md) を参照。

## オーバーフィッティング（過学習）— 最重要警告

### なぜオーバーフィッティングが最大の敵か

過去のデータには「シグナル（繰り返される本当のパターン）」と「ノイズ（偶然の変動）」が混在している。パラメータを増やせば増やすほど、ノイズにもフィットしてしまい、バックテストの成績は上がるが、将来のリアル取引では機能しない。

```
パラメータ数と過学習の関係:

パラメータ 2個: シンプル。過学習リスク低。ただし表現力も低い
パラメータ 5個: バランス良好。多くの戦略はこの範囲
パラメータ10個: 危険信号。過学習リスク大
パラメータ20個: ほぼ確実に過学習。カーブフィッティング
```

### 過学習の兆候

以下の兆候が見られたら、過学習を疑え：

1. **バックテストの成績が異常に良い**: シャープレシオ>3.0は疑わしい
2. **わずかなパラメータ変更で成績が激変する**: ロバストネスが低い
3. **インサンプルとアウトサンプルの成績差が大きい**: 最も確実な兆候
4. **取引ルールが複雑すぎる**: 「RSI<25 かつ MACD>0 かつ 火曜日 かつ VIX<20 かつ...」
5. **特定の期間だけ異常に強い**: 特定イベントにフィットしている

### 過学習対策

| 対策 | 方法 |
|------|------|
| パラメータ数を制限 | 5個以下を目安 |
| ウォークフォワード検証 | 訓練期間と検証期間を分ける |
| 複数期間でテスト | 異なる市場環境で検証 |
| シンプルさを重視 | 同じ成績ならルールが少ない方を選ぶ |
| 統計的検定 | p値 < 0.05を確認 |

## LLMの独自のエッジ

LLMがアルゴリズムトレーディングで発揮できる具体的な優位性は [references/llm-edge.md](references/llm-edge.md) を参照。

## 戦略設計チェックリスト

戦略を完成させる前に、以下を必ず確認せよ：

- [ ] 仮説が明確に言語化されているか
- [ ] 仮説に理論的根拠があるか
- [ ] エントリー・エグジット条件が明確か
- [ ] ポジションサイズの決め方が定義されているか
- [ ] ストップロスが設定されているか
- [ ] パラメータ数は5個以下か
- [ ] バックテストでルックアヘッドバイアスがないか
- [ ] インサンプル/アウトサンプルの分割をしているか
- [ ] ウォークフォワード検証を行ったか
- [ ] スリッページ・手数料を考慮しているか
- [ ] 異なる市場環境（ブル/ベア/レンジ）でテストしたか
- [ ] リスク管理ルールが組み込まれているか
