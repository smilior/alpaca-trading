---
name: strategy-improvement-cycle
description: |
  ペーパートレーディングの結果から学び、戦略を継続的に改善するためのスキル。
  以下のキーワードでトリガーする：「戦略改善」「振り返り」「PDCA」「仮説検証」
  「本番移行」「リアルマネー移行」「リアルトレーディング移行」「パラメータ調整」
  「戦略の修正」「改善サイクル」「レトロスペクティブ」「A/Bテスト」
  「カーブフィッティング」「ペーパーからリアル」。
  ペーパートレーディングの結果分析と戦略修正時に必ず使用すること。
  本番移行の可否判断にも必ず使用すること。
---

# 戦略改善サイクルスキル

## このスキルの目的

ペーパートレーディングの結果から正しく学び、戦略を継続的に改善せよ。「改善」と「カーブフィッティング」を混同しないことが最も重要。

## 改善サイクルの基本

```
仮説 → 実行 → 測定 → 学習 → 修正 → 仮説（繰り返し）

1. 仮説: 「RSIの閾値を30→25に変えると偽シグナルが減るはず」
2. 実行: パラメータを変更してペーパートレーディング
3. 測定: 2週間後にKPIを計測
4. 学習: 「偽シグナルは減ったが、エントリー機会も30%減った」
5. 修正: 「RSI 28に設定し、代わりに出来高フィルターを追加」
```

## 「改善」と「カーブフィッティング」の違い

**これが最も重要な概念。ここを間違えると戦略は確実に失敗する。**

### 改善（良い変更）

```
✅ 特徴:
- 仮説に基づいている（なぜこの変更が効くかの理論がある）
- 1つの変数のみを変更している
- 変更前後の差が統計的に有意
- 論理的に説明可能
- 未知のデータ（アウトサンプル）でも有効

例:
「ボラティリティが高い日にエントリーすると損失が大きい。
→ VIX > 30 の日はエントリーしないルールを追加する。
→ 理由: 高VIX時は方向性予測が困難で、ストップに
  かかりやすい。これは理論的にも実証的にも支持される。」
```

### カーブフィッティング（悪い変更）

```
❌ 特徴:
- 仮説なし（「バックテストでこうした方が成績良かったから」）
- 複数の変数を同時に変更している
- 特定の期間・銘柄でのみ成績が改善
- 論理的な説明が困難
- 未知のデータで成績が悪化する

例:
「バックテストを回して、RSI=27、MA=47日、ストップ=2.3×ATR
  の組み合わせが最適だった。これに変更する。」
→ なぜ27なのか？なぜ47日なのか？理論的根拠がない。
  過去のノイズにフィットしているだけ。
```

### 見分け方チェックリスト

| チェック項目 | 改善 | カーブフィッティング |
|-------------|------|---------------------|
| 変更の理由を論理的に説明できる？ | はい | いいえ |
| 変数は1つだけ変えた？ | はい | いいえ（複数同時） |
| アウトサンプルでも有効？ | はい | インサンプルでのみ有効 |
| パラメータを±10%変えても成績安定？ | はい | 大きく変わる |
| 異なる市場環境でも機能する？ | はい | 特定環境のみ |

## 1つずつ変数を変えるルール

**なぜ重要か**: 複数の変数を同時に変えると、何が効果を生んだか分からなくなる。これは科学実験の基本原則。

```
❌ 悪い例:
「RSIの閾値を変え、MAの期間を変え、
ストップの距離も変えた。成績が上がった！」
→ どの変更が効いたか不明。1つが改善、2つが悪化で
  結果的に少し良くなっただけかもしれない。

✅ 良い例:
Week 1: RSIの閾値を30→25に変更。他はそのまま。
→ 結果: 勝率+3%、取引回数-20%。偽シグナル減少を確認。

Week 3: MAの期間を50→40に変更。RSIは25のまま。
→ 結果: 反応速度は上がったが、ダマシも増加。元に戻す。

Week 5: ストップをATR 2.0→2.5に変更。他はそのまま。
→ 結果: 勝率+5%、ただし平均損失も+15%。トレードオフを検討。
```

## 改善サイクルの具体的な手順

### Step 1: 仮説を立てる

```markdown
## 改善仮説シート

### 仮説
もし[変更内容]を行えば、[期待する効果]が得られるはずだ。

### 根拠
なぜそう考えるか: [理論的根拠 or 観察に基づく根拠]

### 測定方法
- 変更する変数: [1つだけ]
- 測定するKPI: [具体的なKPI]
- 期間: [最低2週間]
- 成功基準: [定量的な基準。例: シャープレシオが0.2以上改善]
- 失敗基準: [定量的な基準。例: 最大ドローダウンが5%以上悪化]

### 比較対象
- 変更前: [現在のパラメータと直近のKPI]
- 変更後: [変更後のパラメータ]
```

### Step 2: 実行

- 変更を加えてペーパートレーディングを実行
- 変更前の設定もバックアップしておく（元に戻せるように）
- 変更日時を記録する

### Step 3: 測定

- 事前に決めたKPIを計測
- 変更前と変更後を同じ基準で比較
- 十分なサンプルサイズがあることを確認（最低20取引）

### Step 4: 学習

```markdown
## 改善結果シート

### 結果
| KPI | 変更前 | 変更後 | 差分 | 統計的有意性 |
|-----|--------|--------|------|-------------|
|     |        |        |      | p値: |

### 判断
- [ ] 採用（改善が統計的に有意）
- [ ] 不採用（改善なし or 悪化）
- [ ] 追加検証が必要（サンプル不足）

### 学んだこと
[仮説は正しかったか？予想外の副作用はあったか？]

### 次の仮説
[この結果から何が次のステップになるか？]
```

### Step 5: 修正

- 採用の場合: 変更を正式パラメータとして記録
- 不採用の場合: 元に戻し、理由を記録
- 追加検証の場合: 期間を延長して再測定

## ペーパーからリアルへの移行基準

**詳細は [references/paper-to-real-criteria.md](references/paper-to-real-criteria.md) を参照。**

### クイックチェックリスト

| 基準 | 条件 | 満たした？ |
|------|------|-----------|
| 最低取引回数 | 100回以上 | [ ] |
| 最低運用期間 | 3ヶ月以上 | [ ] |
| シャープレシオ | > 1.0 | [ ] |
| 最大ドローダウン | < 15% | [ ] |
| プロフィットファクター | > 1.5 | [ ] |
| ベンチマーク超過 | SPYを上回る | [ ] |
| 異なる市場環境を経験 | ブル/ベア/レンジ各1回以上 | [ ] |

**すべての基準を満たすまでリアルマネーに移行してはならない。**

## 仮説検証の詳細

[references/hypothesis-testing.md](references/hypothesis-testing.md) を参照。

## アンチパターン

```
❌ 「先月負けたからパラメータを全部変えよう」
→ 1ヶ月の結果で判断するのは早すぎる。たまたまかもしれない。
  最低3ヶ月のデータで判断せよ。

❌ 「バックテストで最適化したパラメータに変更しよう」
→ バックテスト最適化 = カーブフィッティング。
  仮説に基づく変更のみ行え。

❌ 「勝率を上げるためにストップを広げよう」
→ 勝率は上がるが、平均損失が増える。期待値で判断せよ。

❌ 「3つの変更を同時に適用しよう。時間がもったいない」
→ 何が効いたか分からなくなる。1つずつ変えるルールは絶対。
```
