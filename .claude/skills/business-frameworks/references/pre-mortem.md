# 事前検死（Pre-mortem）リファレンス

## 概要

Gary Kleinが提唱した意思決定手法。通常のリスク分析が「何がうまくいかない可能性があるか？」と問うのに対し、事前検死は「1年後、このプロジェクトは壮大に失敗した。なぜか？」と断定形で問う。

**なぜ事前検死か**: 人間（AIも含む）は「計画を支持する根拠」を探す確証バイアスを持つ。事前検死は「失敗した」と断定することで、このバイアスを強制的に解除し、リスクを洗い出しやすくする。

## 完全な手順

### ステップ1: 失敗の宣言（2分）

以下の文を読み上げ（AIの場合は表示）、全員が失敗を前提として考える態勢を作る：

> 「今から1年後、このプロジェクトは壮大に失敗しました。
> 完全な失敗です。期待した成果は何一つ得られませんでした。
> さて、何が起きたのでしょうか？」

### ステップ2: 個別での失敗原因列挙（10分）

各参加者（各AIエージェント）が独立に失敗原因を列挙する。この段階では他者の意見を見ない（グループシンクを防ぐため）。

**トレーディングプロジェクトでの失敗原因カテゴリ**:

#### A. 技術的失敗
- APIの仕様変更で自動売買が停止した
- バグにより誤った売買が執行された
- データフィードの遅延・欠損により判断を誤った
- バックテスト環境とリアル環境の乖離
- 状態管理の不整合（二重注文、ポジション不整合）

#### B. 戦略的失敗
- 過学習（オーバーフィッティング）した戦略をリアルに適用した
- 市場レジームの変化（ブル→ベア、低ボラ→高ボラ）に対応できなかった
- リスク管理が甘く、1回の暴落で資金の大部分を失った
- バックテストでは優秀だったがリアルではスリッページで利益が消えた

#### C. 運用的失敗
- サーバーダウン中にポジションが放置された
- APIキーが漏洩してアカウントが不正操作された
- Claude APIのコスト管理を怠り、予算超過
- cron実行の設定ミスで市場時間外に注文を出した

#### D. 外部環境の変化
- Alpacaがサービスを変更・停止した
- 規制変更（SECルール等）によりアルゴ取引が制限された
- 市場の異常事態（フラッシュクラッシュ）でシステムが対応不能
- 金利環境の急変でモデルの前提が崩壊した

#### E. 人的要因
- モチベーション低下で運用を放置した
- 儲かって過信し、リスク管理を緩めた
- 損失が続いて感情的に戦略を頻繁に変更した

### ステップ3: 共有と議論（15分）

列挙された失敗原因を全員で共有し、以下の軸で評価する：

| 失敗原因 | 発生確率 | 影響度 | 検出可能性 | リスクスコア |
|----------|----------|--------|------------|------------|
|          | 高/中/低 | 高/中/低 | 高/中/低  | 確率×影響÷検出 |

### ステップ4: 予防策の設計（20分）

リスクスコアの高い順に予防策を設計する。

**予防策の3レベル**:

1. **予防（Prevention）**: そもそも発生しないようにする
   - 例: APIキー漏洩 → 環境変数で管理、.envをgitignoreに追加
2. **検出（Detection）**: 早期に発見する
   - 例: 異常な損失 → 日次ドローダウン5%で自動アラート
3. **対応（Response）**: 発生時のダメージを最小化する
   - 例: サーバーダウン → 全ポジションに事前ストップロス設定

### ステップ5: プレモーテムレポートの作成

```markdown
## プレモーテムレポート

**プロジェクト**: [名前]
**実施日**: [日付]
**参加者**: [エージェント名]

### Top 5 リスクと予防策

| # | リスク | 確率 | 影響 | 予防策 | 検出策 | 対応策 | 担当 |
|---|--------|------|------|--------|--------|--------|------|
| 1 |        |      |      |        |        |        |      |
| 2 |        |      |      |        |        |        |      |
| 3 |        |      |      |        |        |        |      |
| 4 |        |      |      |        |        |        |      |
| 5 |        |      |      |        |        |        |      |

### 受容するリスク（対策コスト > 期待損失）
- [リスクと受容理由]

### レビュー予定
- [次回見直し日]
```

## 良い事前検死と悪い事前検死

```
❌ 悪い例:
「失敗原因: 市場が下がった」
→ 具体性がなく、対策が立てられない

✅ 良い例:
「失敗原因: FRBの予想外の利上げにより、
テック株中心のポートフォリオが2週間で20%下落。
ATRベースのストップロスが機能したが、
ギャップダウンにより実際の損失が想定の2倍になった。
さらにその後の反発を逃し、損失だけ確定した」
→ 具体的なシナリオがあり、各ポイントで対策を検討できる
```

## AIエージェントでの実施方法

1. 各エージェントに独立して失敗原因を列挙させる（ステップ2を並列実行）
2. 結果を集約し、重複を排除
3. リスクスコアの評価は全エージェントの合議で決定
4. 予防策はそれぞれの専門領域のエージェントが担当
